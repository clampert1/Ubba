<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UBBA Dance Battle</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:#000;color:#fff;font-family:Arial, sans-serif;overflow:hidden;}
#game-container{position:relative;width:100vw;height:100vh;}
#background{
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:url('https://raw.githubusercontent.com/clampert1/Ubba/main/ubba-arg/assets/cameras/office.png') center/cover no-repeat;
  filter:brightness(0.4);
}

/* === HEALTH === */
#health-container{
  position:absolute;top:20px;left:50%;transform:translateX(-50%);
  width:80%;display:flex;justify-content:space-between;align-items:center;
}
.health-bar{width:400px;height:30px;background:#333;border:2px solid #fff;border-radius:5px;overflow:hidden;position:relative;}
.health-fill{position:absolute;top:0;left:0;height:100%;background:#0f0;transition:width .3s ease;}
#ubba-health .health-fill{background:#f00;right:0;left:auto;}
.health-label{position:absolute;width:100%;text-align:center;line-height:30px;font-weight:bold;text-shadow:1px 1px 2px #000;}

/* === ARROW ZONES === */
#lanes-container{
  position:absolute;top:80px;left:50%;transform:translateX(-50%);
  display:flex;gap:200px;
}
.lane-side{display:flex;gap:20px;}
.arrow-lane{width:90px;height:100px;position:relative;}
.static-arrow{
  position:absolute;bottom:0;left:50%;transform:translateX(-50%);
  width:70px;height:70px;border:3px solid;border-radius:8px;
  background:#222;display:flex;align-items:center;justify-content:center;
  color:#fff;font-size:22px;font-weight:bold;transition:.1s;
}
.static-arrow.active{background:#0f0;transform:translateX(-50%) scale(1.15);}
.static-arrow.left{border-color:#4ecdc4;}
.static-arrow.down{border-color:#ffe66d;}
.static-arrow.up{border-color:#ff6b6b;}
.static-arrow.right{border-color:#ff9f1c;}

/* === FALLING ARROWS === */
#falling-arrows-container{position:absolute;bottom:0;left:0;width:100%;height:100%;pointer-events:none;}
.falling-arrow{
  position:absolute;width:70px;height:70px;border:3px solid;border-radius:8px;
  display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:bold;
}
.falling-arrow.left{background:#4ecdc4;border-color:#4ecdc4;}
.falling-arrow.down{background:#ffe66d;color:#000;border-color:#ffe66d;}
.falling-arrow.up{background:#ff6b6b;border-color:#ff6b6b;}
.falling-arrow.right{background:#ff9f1c;border-color:#ff9f1c;}

/* === CHARACTERS === */
#characters{
  position:absolute;bottom:60px;left:50%;transform:translateX(-50%);
  display:flex;justify-content:space-between;gap:400px;
}
.character{
  width:180px;height:180px;border:3px solid #fff;border-radius:10px;
  display:flex;align-items:center;justify-content:center;font-size:24px;
}
#player-character{background:linear-gradient(135deg,#1e3c72,#2a5298);}
#ubba-character{
  background:url('https://raw.githubusercontent.com/clampert1/Ubba/main/ubba-arg/assets/sprites/ubba.png') center/contain no-repeat;
  background-color:#000;
}

/* === UI === */
#score-display{position:absolute;top:130px;left:50%;transform:translateX(-50%);font-size:26px;}
#combo-display{position:absolute;top:165px;left:50%;transform:translateX(-50%);font-size:22px;display:none;}
#bot-turn{position:absolute;top:200px;left:50%;transform:translateX(-50%);font-size:30px;color:#ff0;display:none;font-weight:bold;}
#level-display{position:absolute;top:240px;left:50%;transform:translateX(-50%);font-size:24px;}
#start-screen,#results-screen{
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.85);
  display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:100;
}
#results-screen{display:none;}
.battle-button{background:#ff6b6b;color:#fff;border:2px solid #fff;padding:16px 30px;font-size:22px;border-radius:10px;cursor:pointer;}
.battle-button:hover{background:#ff8b8b;}
</style>
</head>
<body>
<div id="game-container">
  <div id="background"></div>
  <div id="health-container">
    <div class="health-bar" id="player-health"><div class="health-fill" style="width:100%"></div><div class="health-label">PLAYER</div></div>
    <div class="health-bar" id="ubba-health"><div class="health-fill" style="width:100%"></div><div class="health-label">UBBA</div></div>
  </div>
  <div id="score-display">SCORE: 0</div>
  <div id="combo-display">COMBO: 0</div>
  <div id="bot-turn">UBBA'S TURN</div>
  <div id="level-display">LEVEL 1</div>

  <div id="lanes-container">
    <div class="lane-side" id="player-lane">
      <div class="arrow-lane"><div class="static-arrow left">A</div></div>
      <div class="arrow-lane"><div class="static-arrow down">S</div></div>
      <div class="arrow-lane"><div class="static-arrow up">W</div></div>
      <div class="arrow-lane"><div class="static-arrow right">D</div></div>
    </div>
    <div class="lane-side" id="ubba-lane">
      <div class="arrow-lane"><div class="static-arrow left">←</div></div>
      <div class="arrow-lane"><div class="static-arrow down">↓</div></div>
      <div class="arrow-lane"><div class="static-arrow up">↑</div></div>
      <div class="arrow-lane"><div class="static-arrow right">→</div></div>
    </div>
  </div>

  <div id="falling-arrows-container"></div>

  <div id="characters">
    <div class="character" id="player-character">YOU</div>
    <div class="character" id="ubba-character"></div>
  </div>

  <div id="start-screen">
    <h1 style="font-size:44px;margin-bottom:20px;">UBBA DANCE BATTLE</h1>
    <button class="battle-button" onclick="startGame()">START</button>
  </div>
  <div id="results-screen">
    <h1 id="result-title" style="font-size:44px;">VICTORY!</h1>
    <p id="result-score"></p><p id="result-combo"></p>
    <button class="battle-button" onclick="location.reload()">PLAY AGAIN</button>
  </div>
</div>

<script>
const CONFIG={ARROW_SPEED:3,SPAWN_RATE:700,HIT_TOL:50};
const KEY_MAP={a:'left',s:'down',w:'up',d:'right'};
const ARROW_SYMBOLS={left:'←',down:'↓',up:'↑',right:'→'};
const game={isPlaying:false,isBotTurn:true,score:0,combo:0,maxCombo:0,playerHP:100,ubbaHP:100,level:1,total:3,seq:[],playerSeq:[],arrows:[]};
const els={
  start:document.getElementById('start-screen'),
  results:document.getElementById('results-screen'),
  score:document.getElementById('score-display'),
  combo:document.getElementById('combo-display'),
  bot:document.getElementById('bot-turn'),
  pHP:document.querySelector('#player-health .health-fill'),
  uHP:document.querySelector('#ubba-health .health-fill'),
  f:document.getElementById('falling-arrows-container'),
  rTitle:document.getElementById('result-title'),
  rScore:document.getElementById('result-score'),
  rCombo:document.getElementById('result-combo')
};

function startGame(){
  els.start.style.display='none';game.isPlaying=true;nextLevel();
  requestAnimationFrame(loop);
}
function nextLevel(){
  game.seq=genSeq();game.playerSeq=[];game.isBotTurn=true;
  els.bot.style.display='block';
  playBotSeq(()=>{game.isBotTurn=false;spawnPlayerArrows();});
}
function genSeq(){const arr=[],keys=['left','down','up','right'];for(let i=0;i<8;i++)arr.push(keys[Math.floor(Math.random()*4)]);return arr;}
function playBotSeq(done){let i=0;const t=setInterval(()=>{if(i>=game.seq.length){clearInterval(t);els.bot.style.display='none';done();return;}spawnArrow(game.seq[i],'right');i++;},CONFIG.SPAWN_RATE);}
function spawnPlayerArrows(){let i=0;const t=setInterval(()=>{if(i>=game.seq.length){clearInterval(t);return;}spawnArrow(game.seq[i],'left');i++;},CONFIG.SPAWN_RATE);}
function spawnArrow(type,side){
  const el=document.createElement('div');el.className=`falling-arrow ${type}`;el.textContent=ARROW_SYMBOLS[type];
  const baseX=(window.innerWidth/2)+(side==='left'?-200:200);
  const offset={left:-135,down:-45,up:45,right:135};
  el.style.left=(baseX+offset[type])+'px';
  const chars=document.getElementById('characters').getBoundingClientRect();
  el.style.bottom=(window.innerHeight-chars.top+10)+'px';
  els.f.appendChild(el);
  game.arrows.push({el,type,side,y:parseInt(el.style.bottom),hit:false});
}
function loop(){
  if(!game.isPlaying)return;
  game.arrows.forEach((a,i)=>{
    a.y+=CONFIG.ARROW_SPEED;a.el.style.bottom=a.y+'px';
    if(a.y>window.innerHeight){a.el.remove();game.arrows.splice(i,1);}
  });
  requestAnimationFrame(loop);
}
function checkHit(k){
  if(!game.isPlaying||game.isBotTurn)return;
  const type=KEY_MAP[k];if(!type)return;
  highlightKey(type);
  const target=document.querySelector(`#player-lane .static-arrow.${type}`);
  const targetRect=target.getBoundingClientRect();
  for(const a of game.arrows){
    if(a.side!=='left'||a.type!==type||a.hit)continue;
    const rect=a.el.getBoundingClientRect();
    const centerA=rect.top+rect.height/2;
    const centerT=targetRect.top+targetRect.height/2;
    if(Math.abs(centerA-centerT)<CONFIG.HIT_TOL){
      a.hit=true;a.el.remove();
      game.score+=100;game.combo++;game.maxCombo=Math.max(game.maxCombo,game.combo);
      updateUI();return;
    }
  }
  game.combo=0;updateUI();
}
function highlightKey(type){
  const el=document.querySelector(`#player-lane .static-arrow.${type}`);
  el.classList.add('active');setTimeout(()=>el.classList.remove('active'),150);
}
function updateUI(){
  els.score.textContent=`SCORE: ${game.score}`;
  if(game.combo>1){els.combo.style.display='block';els.combo.textContent=`COMBO: ${game.combo}`;}
  else els.combo.style.display='none';
}
document.addEventListener('keydown',e=>checkHit(e.key.toLowerCase()));
</script>
</body>
</html>
